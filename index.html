<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Formulas & Code Hub — Excel + Python</title>

<style>
:root{
  --bg:#0f1724;
  --card:#0b1020;
  --muted:#9aa7b2;
  --accent:#06bb64;
  --glass: rgba(255,255,255,0.03);
  --code-bg:#071122;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
}

html,body{
  height:100%;
  margin:0;
  padding:0;
  background:linear-gradient(180deg,#071025 0%, #071229 60%);
  color:#e6eef3;
  font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
}

.wrap{
  max-width:1400px;
  margin:40px auto;
  padding:28px;
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:25px;
}

header h1{
  margin:0;
  font-size:30px;
  font-weight:700;
}

.search{
  width:100%;
  display:flex;
  justify-content:center;
  margin-bottom:25px;
}

.search input{
  width:80%;
  padding:14px 16px;
  background:var(--glass);
  border:1px solid rgba(255,255,255,0.1);
  border-radius:10px;
  font-size:17px;
  color:#fff;
  outline:none;
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:22px;
}

.section-title{
  font-size:20px;
  font-weight:600;
  margin-bottom:12px;
}

.card{
  background:var(--card);
  padding:20px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.05);
}

.card h3{
  margin-top:0;
  font-size:18px;
  font-weight:600;
  margin-bottom:14px;
}

.meta{
  color:var(--muted);
  font-size:13px;
  margin-bottom:12px;
}

.pre{
  background:var(--code-bg);
  padding:14px;
  border-radius:10px;
  font-family:var(--mono);
  white-space:pre-wrap;
  word-break:break-word;
  color:#bdeef6;
  font-size:14px;
  border:1px solid rgba(255,255,255,0.05);
}

.copy-btn{
  margin-top:10px;
  background:var(--accent);
  padding:8px 14px;
  border:none;
  border-radius:8px;
  color:#06250d;
  font-weight:700;
  cursor:pointer;
  float:right;
}

.copy-btn:hover{
  opacity:0.85;
}
</style>
</head>

<body>
<div class="wrap">

<header>
  <h1>Formulas & Code Hub — Excel + Python</h1>
</header>

<div class="search">
  <input id="search" placeholder="Search formulas, functions, keywords, Python code...">
</div>

<div class="grid">

<!-- LEFT COLUMN – EXCEL FORMULAS -->
<div id="excel-section">
  <h2 class="section-title">Excel Formulas (All combined, copyable)</h2>

  <!-- FORMULA CARDS WILL BE INJECTED HERE -->
</div>

<!-- RIGHT COLUMN – PYTHON PROGRAMS -->
<div id="python-section">
  <h2 class="section-title">Python Programs (Questions + Code)</h2>

  <!-- PYTHON CARDS WILL BE INJECTED HERE -->
</div>

</div> <!-- grid end -->
</div> <!-- wrap end -->


<script>
/* ================================
   ALL EXCEL FORMULAS (53 TOTAL)
   ================================ */
const excelData = [
  { title:"Calculate Total Sales", formula:"=D2*E2" },
  { title:"Alternate Total Sales", formula:"=E2*F2" },
  { title:"INDEX + MATCH (Find Region of Neha)", formula:'=INDEX(C2:C9, MATCH("Neha", B2:B9, 0))' },
  { title:"UNIQUE Product List", formula:"=UNIQUE(D2:D9)" },
  { title:"IFS Performance Rating", formula:'=IFS(H2>=500000,"Excellent", H2>=300000,"Good", H2<300000,"Needs Improvement")' },
  { title:"COUNTIFS (Ravi in South)", formula:'=COUNTIFS(B2:B9,"Ravi", C2:C9,"South")' },
  { title:"SUMIFS (Laptop + North)", formula:'=SUMIFS(H2:H9, D2:D9,"Laptop", C2:C9,"North")' },
  { title:"AVERAGEIFS (Tablet + Mar)", formula:'=AVERAGEIFS(H2:H9, D2:D9,"Tablet", G2:G9,"Mar")' },
  { title:"VLOOKUP (English Marks of S103)", formula:'=VLOOKUP("S103", A2:F6, 5, FALSE)' },
  { title:"XLOOKUP (English Marks of Diya)", formula:'=XLOOKUP("Diya", B2:B6, F2:F6)' },
  { title:"COUNTA Example", formula:"=COUNTA(B2:B6)" },
  { title:"LEFT + SEARCH (Extract first name from email)", formula:"=LEFT(D2, SEARCH(\".\",D2)-1)" },
  { title:"MID (Extract last name)", formula:"=MID(D2, SEARCH(\".\",D2)+1, SEARCH(\"@\",D2)-SEARCH(\".\",D2)-1)" },
  { title:"RIGHT + LEN (Extract domain)", formula:"=RIGHT(D2, LEN(D2)-SEARCH(\"@\",D2))" },
  { title:"LEN (Phone number length)", formula:"=LEN(E2)" },
  { title:"SUBSTITUTE (+91 removal)", formula:'=SUBSTITUTE(E2, "+91-", "")' },
  { title:"SEARCH + ISNUMBER", formula:'=ISNUMBER(SEARCH("a", C2))' },
  { title:"TODAY()", formula:"=TODAY()" },
  { title:"NOW()", formula:"=NOW()" },
  { title:"YEAR", formula:"=YEAR(C2)" },
  { title:"MONTH", formula:"=MONTH(C2)" },
  { title:"NETWORKDAYS", formula:"=NETWORKDAYS(C2, D2)" },
  { title:"EOMONTH", formula:"=EOMONTH(C2, 0)" },
  { title:"OFFSET + AVERAGE (3-row window)", formula:"=AVERAGE(OFFSET($D$2,0,0,3,1))" },
  { title:"RANK.EQ", formula:"=RANK.EQ(D2, $D$2:$D$9, 0)" },
  { title:"LET Example", formula:'=LET(ms, MAX($D$2:$D$9), IF(D5=ms, "Top Seller",""))' },
  { title:"CHOOSE Quarter", formula:'=CHOOSE(MONTH(DATEVALUE("1 "&E2)),"Q1","Q2","Q3","Q4")' },
  { title:"SORT Descending", formula:"=SORT(D2:D9, 1, -1)" },
  { title:"SORTBY (Names by Sales)", formula:"=SORTBY(B2:B9, D2:D9, -1)" },
  { title:"MAX Total Sales", formula:"=MAX(D2:D9)" },
  { title:"FILTER (Maths > 85)", formula:"=FILTER(A2:E11, D2:D11>85)" },
  { title:"FREQUENCY Example", formula:"=FREQUENCY(D2:D11, {60,70,80,90,100})" },
  { title:"SEQUENCE Example", formula:"=SEQUENCE(10,1,1,1)" },
  { title:"RANDARRAY Example", formula:"=RANDARRAY(10,1,50,100,TRUE)" },
  { title:"IFERROR Example", formula:'=IFERROR(VLOOKUP("S120", A2:E11, 2, FALSE), "Not Found")' }
];

/* ================================
   ALL PYTHON PROGRAMS (9 TOTAL)
   ================================ */
const pythonData = [
 {
  title:"Perform t-test (Independent Samples)",
  code:`import numpy as np
from scipy.stats import ttest_ind

a = [25, 28, 30, 26, 29, 27, 31, 22]
b = [22, 24, 23, 20, 25, 21, 22, 20]

t, p = ttest_ind(a, b)
print(f"T={t:.2f}, P={p:.4f}")

print("Significant" if p < 0.05 else "Not Significant")`
 },

 {
  title:"Perform ANOVA",
  code:`import numpy as np
from scipy.stats import f_oneway

g1 = [12, 15, 14, 16, 11]
g2 = [10, 9, 14, 13, 12]
g3 = [13, 16, 15, 17, 14]

f, p = f_oneway(g1, g2, g3)
print(f"F={f:.2f}, P={p:.4f}")`
 },

 {
  title:"Z-test",
  code:`import numpy as np
from statsmodels.stats.weightstats import ztest

sample = [55, 60, 62, 58, 57]
z, p = ztest(sample, value=50)
print(f"Z={z:.2f}, P={p:.4f}")`
 },

 {
  title:"Chi-Square Test",
  code:`import numpy as np
from scipy.stats import chi2_contingency

table = [[20, 30], [15, 35]]
chi, p, dof, exp = chi2_contingency(table)
print("Chi-Square:", chi)
print("P-value:", p)`
 },

 {
  title:"Linear Regression",
  code:`import numpy as np
from sklearn.linear_model import LinearRegression

X = np.array([[1],[2],[3],[4],[5]])
y = np.array([2, 4, 5, 4, 5])

model = LinearRegression()
model.fit(X, y)

print("Slope:", model.coef_[0])
print("Intercept:", model.intercept_)`
 },

 {
  title:"Correlation Coefficient",
  code:`import numpy as np

x = [10,20,30,40,50]
y = [15,25,35,30,50]

corr = np.corrcoef(x,y)[0,1]
print("Correlation:", corr)`
 },

 {
  title:"Random Walk Simulation",
  code:`import numpy as np

pos = 0
steps = []

for _ in range(100):
    step = np.random.choice([-1, 1])
    pos += step
    steps.append(pos)

print(steps[:20])`
 },

 {
  title:"Poisson Distribution Example",
  code:`import numpy as np

lam = 4
samples = np.random.poisson(lam, 20)
print(samples)`
 },

 {
  title:"Monte Carlo π Estimation",
  code:`import random
inside = 0
total = 10000

for _ in range(total):
    x, y = random.random(), random.random()
    if x*x + y*y <= 1:
        inside += 1

pi = 4 * inside / total
print("Estimated π:", pi)`
 }
];

/* ================================
   RENDER CARDS
   ================================ */

function render(){
  const excel = document.getElementById("excel-section");
  const python = document.getElementById("python-section");

  excelData.forEach(f=>{
    excel.innerHTML += `
      <div class="card">
        <h3>${f.title}</h3>
        <div class="meta">Exact formula (copyable)</div>
        <div class="pre" id="x_${f.title.replace(/\s+/g,'_')}">${f.formula}</div>
        <button class="copy-btn" onclick="copyText('x_${f.title.replace(/\s+/g,'_')}')">Copy</button>
      </div>`;
  });

  pythonData.forEach(p=>{
    python.innerHTML += `
      <div class="card">
        <h3>${p.title}</h3>
        <div class="meta">Question + Code (copyable)</div>
        <div class="pre" id="p_${p.title.replace(/\s+/g,'_')}">${p.code}</div>
        <button class="copy-btn" onclick="copyText('p_${p.title.replace(/\s+/g,'_')}')">Copy</button>
      </div>`;
  });
}

render();

/* ================================
   COPY FUNCTION
   ================================ */
function copyText(id){
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text);
  alert("Copied!");
}

/* ================================
   SEARCH FILTER
   ================================ */
document.getElementById("search").addEventListener("keyup", function(){
  let q = this.value.toLowerCase();
  document.querySelectorAll(".card").forEach(card=>{
    card.style.display = card.innerText.toLowerCase().includes(q) ? "block" : "none";
  });
});
</script>

</body>
</html>
